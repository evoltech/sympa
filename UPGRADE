Instructions to upgrade sympa for riseup:

1. Download and untar new source

2. convert official patches from last version to work with new version

   These are the current patches we use, and how to test they are working (where necessary):

   a. do not change renames to pending status
   b. do not allow list creation by copying an existing list 
      this is disabled in the templates, mainly, but this disables it in the function too in case it gets past the template

3. run configure: 
./configure --with-confdir=/etc/sympa --with-initdir=/etc/init.d/ 

4. compile sympa:
./make

5. stop services:
puppetd --disable
/etc/init.d/sympa stop
postfix stop

6. install sympa
./make install

7. look at sympa.pl --upgrade and see if there's anything we can skip
7a. run sympa.pl --upgrade

8. enable puppet, which will fix the templates and scenari files, and restart sympa & postfix
8a. do it without any real changes first:
    puppetd --enable; puppetd --test --noop; puppetd --disable
8b. provided that went well, reenable puppet:
    puppetd --enable

9. check create list templates
   the following list types only should be available on the create lists page:
     1-moderated-discussion-list
     2-open-discussion-list
     3-private-working-group
     4-public-working-group
     5-newsletter

10. check scenari files
   scenari files describe permissions for subscribing and unsubscribing, among other things. we have some scenaris
   disabled (for example, the scenari that closes unsubscribing).  
   the files in scenari/ in the repo should be the only scenaris enabled, like so:
   scenari/etc/* -> /home/sympa/etc/scenari/
   scenari/default/* -> /home/smpa/default/scenari/
